#0Y UTF-8

(PROGN (SETQ *PACKAGE* (SYSTEM::%FIND-PACKAGE "INTERACTORS")))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *MODIFIER-TRANSLATIONS*)))
(PROGN
 (SYSTEM::C-DEFUN 'DEFINE-KEYBOARD-MODIFIER
  (SYSTEM::LAMBDA-LIST-TO-SIGNATURE '(CLX-MASK MODIFIER-NAME))))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *NUM-MODIFIER-KEYS*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *NUM-MOUSE-BUTTONS*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *MOUSE-TRANSLATION-DIMENSIONS*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *MOUSE-DOWN-TRANSLATIONS*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *MOUSE-UP-TRANSLATIONS*)))
(PROGN (SYSTEM::REMOVE-OLD-DEFINITIONS 'MOUSE-INDEX)
 (SYSTEM::%PUTD 'MOUSE-INDEX
  (SYSTEM::MAKE-MACRO
   (FUNCTION MOUSE-INDEX
    (LAMBDA (SYSTEM::<MACRO-FORM> &OPTIONAL SYSTEM::<ENV-ARG>)
     (DECLARE (CONS SYSTEM::<MACRO-FORM>)) (DECLARE (IGNORE SYSTEM::<ENV-ARG>))
     (IF (/= (LENGTH SYSTEM::<MACRO-FORM>) 2.)
      (SYSTEM::MACRO-CALL-ERROR SYSTEM::<MACRO-FORM>)
      (LET* ((MODIFIER-BITS (CADR SYSTEM::<MACRO-FORM>)))
       (BLOCK MOUSE-INDEX
        `(LET ((SUM 0.))
          (DOLIST (MOD-BIT ,MODIFIER-BITS)
           (INCF SUM (CAR (RASSOC MOD-BIT *MODIFIER-TRANSLATIONS*))))
          SUM)))))))))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *LEFT-BUTTON*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *MIDDLE-BUTTON*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *RIGHT-BUTTON*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *DOUBLE-OFFSET*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *DOUBLE-LEFT-BUTTON*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *DOUBLE-MIDDLE-BUTTON*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *DOUBLE-RIGHT-BUTTON*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *DOUBLE-CLICK-TIME*)))
(PROGN (SYSTEM::REMOVE-OLD-DEFINITIONS 'DEFINE-MOUSE-UP)
 (SYSTEM::%PUTD 'DEFINE-MOUSE-UP
  (SYSTEM::MAKE-MACRO
   (FUNCTION DEFINE-MOUSE-UP
    (LAMBDA (SYSTEM::<MACRO-FORM> &OPTIONAL SYSTEM::<ENV-ARG>)
     (DECLARE (CONS SYSTEM::<MACRO-FORM>)) (DECLARE (IGNORE SYSTEM::<ENV-ARG>))
     (IF (/= (LENGTH SYSTEM::<MACRO-FORM>) 4.)
      (SYSTEM::MACRO-CALL-ERROR SYSTEM::<MACRO-FORM>)
      (LET*
       ((BUTTON (CADR . #1=(SYSTEM::<MACRO-FORM>)))
        (MODIFIER-BITS (CADDR . #1#)) (GARNET-KEYWORD (CADDDR . #1#)))
       (BLOCK DEFINE-MOUSE-UP
        `(SETF
          (AREF *MOUSE-UP-TRANSLATIONS* ,BUTTON (MOUSE-INDEX ,MODIFIER-BITS))
          ,GARNET-KEYWORD)))))))))
(PROGN (SYSTEM::REMOVE-OLD-DEFINITIONS 'DEFINE-MOUSE-DOWN)
 (SYSTEM::%PUTD 'DEFINE-MOUSE-DOWN
  (SYSTEM::MAKE-MACRO
   (FUNCTION DEFINE-MOUSE-DOWN
    (LAMBDA (SYSTEM::<MACRO-FORM> &OPTIONAL SYSTEM::<ENV-ARG>)
     (DECLARE (CONS SYSTEM::<MACRO-FORM>)) (DECLARE (IGNORE SYSTEM::<ENV-ARG>))
     (IF (/= (LENGTH SYSTEM::<MACRO-FORM>) 4.)
      (SYSTEM::MACRO-CALL-ERROR SYSTEM::<MACRO-FORM>)
      (LET*
       ((BUTTON (CADR . #1=(SYSTEM::<MACRO-FORM>)))
        (MODIFIER-BITS (CADDR . #1#)) (GARNET-KEYWORD (CADDDR . #1#)))
       (BLOCK DEFINE-MOUSE-DOWN
        `(SETF
          (AREF *MOUSE-DOWN-TRANSLATIONS* ,BUTTON (MOUSE-INDEX ,MODIFIER-BITS))
          ,GARNET-KEYWORD)))))))))
(PROGN (SYSTEM::REMOVE-OLD-DEFINITIONS 'MODIFIER-INDEX)
 (SYSTEM::%PUTD 'MODIFIER-INDEX
  (SYSTEM::MAKE-MACRO
   (FUNCTION MODIFIER-INDEX
    (LAMBDA (SYSTEM::<MACRO-FORM> &OPTIONAL SYSTEM::<ENV-ARG>)
     (DECLARE (CONS SYSTEM::<MACRO-FORM>)) (DECLARE (IGNORE SYSTEM::<ENV-ARG>))
     (IF (/= (LENGTH SYSTEM::<MACRO-FORM>) 2.)
      (SYSTEM::MACRO-CALL-ERROR SYSTEM::<MACRO-FORM>)
      (LET* ((INCOMING-BITS (CADR SYSTEM::<MACRO-FORM>)))
       (BLOCK MODIFIER-INDEX
        `(LET ((SUM 0.))
          (DOLIST (ELE *MODIFIER-TRANSLATIONS*)
           (LET ((BIT (CAR ELE)))
            (UNLESS (ZEROP (LOGAND BIT ,INCOMING-BITS)) (INCF SUM BIT))))
          SUM)))))))))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *IGNORE-UNDEFINED-KEYS*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *KEYSYM-TRANSLATIONS*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *THE-KEYWORD-PACKAGE*)))
(PROGN
 (SYSTEM::C-DEFUN 'DEFINE-KEYSYM
  (SYSTEM::LAMBDA-LIST-TO-SIGNATURE '(KEYSYM CHAR))))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *KATIE-BASE-CHAR*)))
(PROGN (SYSTEM::C-PROCLAIM '(SPECIAL *PREFIXES*)))
(PROGN
 (SYSTEM::C-DEFUN 'MAKE-KEYWORD-CHAR
  (SYSTEM::LAMBDA-LIST-TO-SIGNATURE '(SYMBOL BITS))))
(PROGN
 (SYSTEM::C-DEFUN 'BASE-CHAR-TO-CHARACTER
  (SYSTEM::LAMBDA-LIST-TO-SIGNATURE '(BASE-CHAR BITS))))